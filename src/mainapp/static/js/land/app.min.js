/**
 * Created by -- on 07.02.2018.
 */

$(document).ready(function(){
    var $window=$(window),
        $htmlbody = $("html, body"),
        $html = $("html");

    $('.trainers__item').on('click', function () {
        var $this = $(this),
            id = $this.data('modal'),
            $target = $(''+id)

        $target.arcticmodal();
        $target.find('.trainers-modals__close').on('click', function () {
            $target.arcticmodal('close');
        })
    });

    $('.action__order  .bt, .action__order2').on('click', function (e) {
        e.preventDefault();
        var $this = $(this),
            $order = $($this.attr('href'));

        $htmlbody.stop().animate({
            scrollTop: $order.offset().top-160
        }, 300);
    });

    function loadImage(target, image, thumbnail){
        var href = target.attr('href'),
            src = target.data('image'),
            title = target.data('title'),
            description = target.data('description'),
            attr = {
                "src": src,
                "alt": title,
            };

        var h = image.height();
        $galleryImage.height(h);
        image.attr(attr).hide();
        $preloader.fadeIn();
        $galleryInfo.hide();


        $galleryName.html(title);
        $galleryDescription.html(description);

        if(thumbnail){
            var index = $galleryThumbnail.index(target);
            console.log(index);
            $galleryThumbnail.removeClass('gallery__thumbnail_active');
            target.addClass('gallery__thumbnail_active');

            $galleryItem.removeClass('gallery__item_active');
            $galleryItem.eq(index).addClass('gallery__item_active');
        }else{
            var index = $galleryItem.index(target);
            $galleryItem.removeClass('gallery__item_active');
            target.addClass('gallery__item_active');
            $galleryThumbnail.removeClass('gallery__thumbnail_active');
            $galleryThumbnail.eq(index).addClass('gallery__thumbnail_active');

        }

        image.on('load',function(e) {
            var h = $(e.target).height();
            $galleryImage.stop().animate({ height: h}, 200, function(){
                $galleryInfo.slideDown(300);
                image.fadeIn(300);
                $galleryImage.attr('style', '');
                $preloader.hide();
            });
        });
    }

    var $gallery = $('.action__gallery');
    if($gallery.length) {
        var $galleryThumbnail = $gallery.find('.gallery__thumbnail'),
            $galleryItem = $gallery.find('.gallery__item'),
            $galleryImage = $gallery.find('.gallery__image'),
            $galleryName = $gallery.find('.gallery__name'),
            $galleryDescription = $gallery.find('.gallery__description'),
            $galleryImg = $gallery.find('.gallery__image img'),
            $preloader = $gallery.find('.preloader'),
            $galleryInfo = $gallery.find('.gallery__info');

        $galleryThumbnail.on('click', function () {
            var $this = $(this);
                loadImage($this, $galleryImg, true);
        });

        $galleryItem.on('click', function () {
            var $this = $(this);
                loadImage($this, $galleryImg, false);
        })
    }
});

